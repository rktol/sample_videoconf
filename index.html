<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.webrtc.ecl.ntt.com/skyway-latest.js"></script>
  <title>SkyWayチュートリアル</title>
</head>
<body>
  <video id="my-video" width="400px" autoplay muted playsinline></video>
  <p id="my-id"></p>




  <script>
    let localStream;

    //カメラ映像を取得する
    navigator.mediaDevices.getUserMedia({video: true, audio:true})
    .then( stream => {
      //成功時にvideo要素にカメラ映像をセットし、再生
      const videoElm = document.getElementById('my-video')
      videoElm.srcObject = stream;
      videoElm.play();
      // 着信時に相手にカメラ映像を返せるようにグローバル変数に保存
      localStream = stream;
    }).catch( error => {
      // 失敗時にエラーログ
      console.error('mediaDevice.getUserMedia() error:',error);
      return;
    });

    const peer = new Peer({
      key: '05391f01-b3c5-41b4-99d7-e565dcbc1003',
      debug: 3
    });

    peer.on('open', () => {
      document.getElementById('my-id').textContent = peer.id;
    });

  </script>
</body>
</html>